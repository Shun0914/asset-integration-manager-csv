{"ast":null,"code":"var _jsxFileName = \"/Users/shunsukeshimojo/Downloads/mcp_server_demo/asset_integration_manager/frontend/src/components/Charts/ProfitLossChart.jsx\",\n  _s = $RefreshSig$();\n/**\n * 損益状況棒グラフコンポーネント\n * ポートフォリオ内の各銘柄の損益を棒グラフで表示\n */\nimport React, { useContext, useMemo } from 'react';\nimport { Box, Paper, Typography, useTheme } from '@mui/material';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from 'chart.js';\nimport { Bar } from 'react-chartjs-2';\nimport { PortfolioContext } from '../../context/PortfolioContext';\n\n// Chart.jsコンポーネントの登録\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\n\n// 通貨フォーマット関数\nconst formatCurrency = value => {\n  return new Intl.NumberFormat('ja-JP', {\n    style: 'currency',\n    currency: 'JPY',\n    maximumFractionDigits: 0\n  }).format(value);\n};\nconst ProfitLossChart = () => {\n  _s();\n  const theme = useTheme();\n  const {\n    portfolioData\n  } = useContext(PortfolioContext);\n\n  // データが存在しない場合はレンダリングしない\n  if (!portfolioData || !portfolioData.items || portfolioData.items.length === 0) {\n    return /*#__PURE__*/_jsxDEV(Paper, {\n      elevation: 2,\n      sx: {\n        p: 3,\n        textAlign: 'center',\n        height: '100%',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        color: \"text.secondary\",\n        children: \"\\u640D\\u76CA\\u30C7\\u30FC\\u30BF\\u304C\\u3042\\u308A\\u307E\\u305B\\u3093\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this);\n  }\n\n  // 棒グラフ用にデータを加工\n  const chartData = useMemo(() => {\n    // データを損益の降順にソート\n    const sortedItems = [...portfolioData.items].sort((a, b) => b.profit_loss - a.profit_loss);\n\n    // 上位7銘柄と下位3銘柄を抽出（計10銘柄）\n    const topItems = sortedItems.slice(0, 7);\n    const bottomItems = sortedItems.slice(-3);\n    const selectedItems = [...topItems, ...bottomItems];\n\n    // 銘柄が10個未満の場合は全て表示\n    const itemsToShow = portfolioData.items.length <= 10 ? sortedItems : selectedItems;\n\n    // グラフ用のデータを作成\n    const labels = itemsToShow.map(item => item.name);\n    const profitLossData = itemsToShow.map(item => item.profit_loss);\n    const colors = itemsToShow.map(item => item.profit_loss >= 0 ? theme.palette.success.main : theme.palette.error.main);\n    return {\n      labels,\n      datasets: [{\n        label: '損益',\n        data: profitLossData,\n        backgroundColor: colors,\n        borderColor: colors.map(color => color),\n        borderWidth: 1\n      }],\n      items: itemsToShow\n    };\n  }, [portfolioData.items, theme.palette.success.main, theme.palette.error.main]);\n\n  // グラフのオプション設定\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    indexAxis: 'y',\n    plugins: {\n      legend: {\n        display: false\n      },\n      tooltip: {\n        callbacks: {\n          title: tooltipItems => {\n            return tooltipItems[0].label;\n          },\n          label: context => {\n            const item = chartData.items[context.dataIndex];\n            const profitLoss = formatCurrency(item.profit_loss);\n            const profitLossRate = `${item.profit_loss_rate.toFixed(2)}%`;\n            return [`損益: ${profitLoss}`, `損益率: ${profitLossRate}`, `評価額: ${formatCurrency(item.value)}`, `保有数量: ${item.quantity}`];\n          }\n        }\n      }\n    },\n    scales: {\n      x: {\n        grid: {\n          display: true,\n          color: theme.palette.divider\n        },\n        ticks: {\n          callback: value => formatCurrency(value)\n        }\n      },\n      y: {\n        grid: {\n          display: false\n        }\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Paper, {\n    elevation: 2,\n    sx: {\n      p: 3,\n      borderRadius: 2,\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h6\",\n      gutterBottom: true,\n      sx: {\n        fontWeight: 'medium',\n        mb: 2\n      },\n      children: \"\\u9298\\u67C4\\u5225\\u640D\\u76CA\\u72B6\\u6CC1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        flexGrow: 1,\n        height: '300px',\n        position: 'relative'\n      },\n      children: /*#__PURE__*/_jsxDEV(Bar, {\n        data: chartData,\n        options: options\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }, this), portfolioData.items.length > 10 && /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"caption\",\n      sx: {\n        mt: 2,\n        textAlign: 'center',\n        color: 'text.secondary'\n      },\n      children: \"\\u203B \\u640D\\u76CA\\u4E0A\\u4F4D7\\u9298\\u67C4\\u3068\\u4E0B\\u4F4D3\\u9298\\u67C4\\u3092\\u8868\\u793A\\u3057\\u3066\\u3044\\u307E\\u3059\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 5\n  }, this);\n};\n_s(ProfitLossChart, \"IPDJBSJ0eeAmGxMSp0dmU2RgYpU=\", false, function () {\n  return [useTheme];\n});\n_c = ProfitLossChart;\nexport default ProfitLossChart;\nvar _c;\n$RefreshReg$(_c, \"ProfitLossChart\");","map":{"version":3,"names":["React","useContext","useMemo","Box","Paper","Typography","useTheme","Chart","ChartJS","CategoryScale","LinearScale","BarElement","Title","Tooltip","Legend","Bar","PortfolioContext","jsxDEV","_jsxDEV","register","formatCurrency","value","Intl","NumberFormat","style","currency","maximumFractionDigits","format","ProfitLossChart","_s","theme","portfolioData","items","length","elevation","sx","p","textAlign","height","display","alignItems","justifyContent","children","variant","color","fileName","_jsxFileName","lineNumber","columnNumber","chartData","sortedItems","sort","a","b","profit_loss","topItems","slice","bottomItems","selectedItems","itemsToShow","labels","map","item","name","profitLossData","colors","palette","success","main","error","datasets","label","data","backgroundColor","borderColor","borderWidth","options","responsive","maintainAspectRatio","indexAxis","plugins","legend","tooltip","callbacks","title","tooltipItems","context","dataIndex","profitLoss","profitLossRate","profit_loss_rate","toFixed","quantity","scales","x","grid","divider","ticks","callback","y","borderRadius","flexDirection","gutterBottom","fontWeight","mb","flexGrow","position","mt","_c","$RefreshReg$"],"sources":["/Users/shunsukeshimojo/Downloads/mcp_server_demo/asset_integration_manager/frontend/src/components/Charts/ProfitLossChart.jsx"],"sourcesContent":["/**\n * 損益状況棒グラフコンポーネント\n * ポートフォリオ内の各銘柄の損益を棒グラフで表示\n */\nimport React, { useContext, useMemo } from 'react';\nimport { Box, Paper, Typography, useTheme } from '@mui/material';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend\n} from 'chart.js';\nimport { Bar } from 'react-chartjs-2';\nimport { PortfolioContext } from '../../context/PortfolioContext';\n\n// Chart.jsコンポーネントの登録\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\n// 通貨フォーマット関数\nconst formatCurrency = (value) => {\n  return new Intl.NumberFormat('ja-JP', {\n    style: 'currency',\n    currency: 'JPY',\n    maximumFractionDigits: 0\n  }).format(value);\n};\n\nconst ProfitLossChart = () => {\n  const theme = useTheme();\n  const { portfolioData } = useContext(PortfolioContext);\n\n  // データが存在しない場合はレンダリングしない\n  if (!portfolioData || !portfolioData.items || portfolioData.items.length === 0) {\n    return (\n      <Paper \n        elevation={2} \n        sx={{ \n          p: 3, \n          textAlign: 'center', \n          height: '100%',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center'\n        }}\n      >\n        <Typography variant=\"body1\" color=\"text.secondary\">\n          損益データがありません\n        </Typography>\n      </Paper>\n    );\n  }\n\n  // 棒グラフ用にデータを加工\n  const chartData = useMemo(() => {\n    // データを損益の降順にソート\n    const sortedItems = [...portfolioData.items].sort((a, b) => b.profit_loss - a.profit_loss);\n    \n    // 上位7銘柄と下位3銘柄を抽出（計10銘柄）\n    const topItems = sortedItems.slice(0, 7);\n    const bottomItems = sortedItems.slice(-3);\n    const selectedItems = [...topItems, ...bottomItems];\n    \n    // 銘柄が10個未満の場合は全て表示\n    const itemsToShow = portfolioData.items.length <= 10 \n      ? sortedItems \n      : selectedItems;\n    \n    // グラフ用のデータを作成\n    const labels = itemsToShow.map(item => item.name);\n    const profitLossData = itemsToShow.map(item => item.profit_loss);\n    const colors = itemsToShow.map(item => \n      item.profit_loss >= 0 ? theme.palette.success.main : theme.palette.error.main\n    );\n    \n    return {\n      labels,\n      datasets: [\n        {\n          label: '損益',\n          data: profitLossData,\n          backgroundColor: colors,\n          borderColor: colors.map(color => color),\n          borderWidth: 1\n        }\n      ],\n      items: itemsToShow\n    };\n  }, [portfolioData.items, theme.palette.success.main, theme.palette.error.main]);\n\n  // グラフのオプション設定\n  const options = {\n    responsive: true,\n    maintainAspectRatio: false,\n    indexAxis: 'y',\n    plugins: {\n      legend: {\n        display: false\n      },\n      tooltip: {\n        callbacks: {\n          title: (tooltipItems) => {\n            return tooltipItems[0].label;\n          },\n          label: (context) => {\n            const item = chartData.items[context.dataIndex];\n            const profitLoss = formatCurrency(item.profit_loss);\n            const profitLossRate = `${item.profit_loss_rate.toFixed(2)}%`;\n            return [\n              `損益: ${profitLoss}`,\n              `損益率: ${profitLossRate}`,\n              `評価額: ${formatCurrency(item.value)}`,\n              `保有数量: ${item.quantity}`\n            ];\n          }\n        }\n      }\n    },\n    scales: {\n      x: {\n        grid: {\n          display: true,\n          color: theme.palette.divider\n        },\n        ticks: {\n          callback: (value) => formatCurrency(value)\n        }\n      },\n      y: {\n        grid: {\n          display: false\n        }\n      }\n    }\n  };\n\n  return (\n    <Paper \n      elevation={2} \n      sx={{ \n        p: 3, \n        borderRadius: 2,\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column'\n      }}\n    >\n      <Typography \n        variant=\"h6\" \n        gutterBottom \n        sx={{ fontWeight: 'medium', mb: 2 }}\n      >\n        銘柄別損益状況\n      </Typography>\n      \n      <Box sx={{ flexGrow: 1, height: '300px', position: 'relative' }}>\n        <Bar data={chartData} options={options} />\n      </Box>\n      \n      {portfolioData.items.length > 10 && (\n        <Typography \n          variant=\"caption\" \n          sx={{ \n            mt: 2, \n            textAlign: 'center',\n            color: 'text.secondary'\n          }}\n        >\n          ※ 損益上位7銘柄と下位3銘柄を表示しています\n        </Typography>\n      )}\n    </Paper>\n  );\n};\n\nexport default ProfitLossChart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}