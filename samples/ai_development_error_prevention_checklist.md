# AI支援開発のためのエラー防止チェックリスト

このチェックリストは、AI支援による開発プロセスにおいて、コード変更前後に実施すべき検証項目をまとめたものです。このプロセスを導入することで、多くの一般的なエラーを未然に防ぎ、開発効率を向上させることができます。

## 1. コード変更前の準備チェック

### 1.1. 変更範囲の明確化
- [ ] 変更するファイルとその依存関係を特定している
- [ ] 変更の影響範囲を明確に把握している
- [ ] 変更が他のコンポーネントに与える影響を考慮している

### 1.2. 既存コードの理解
- [ ] 修正対象ファイルの全体構造を把握している
- [ ] ファイル内の重要な変数・関数の役割を理解している
- [ ] 関連するファイル間の依存関係を理解している

### 1.3. バックアップ戦略
- [ ] 元のファイルのバックアップを作成するか検討している
- [ ] 大幅な変更の場合、一時ファイルに変更を適用することを検討している
- [ ] 変更を段階的に適用するプランを立てている

## 2. コード変更中のチェック

### 2.1. 変更の整合性
- [ ] コード修正が部分的でなく、ファイル全体の整合性を維持している
- [ ] インデントと書式が一貫している
- [ ] 命名規則が既存のコードスタイルと一致している

### 2.2. インポート・エクスポート関連
- [ ] 新しく追加したコードで使用する全てのモジュールがインポートされている
- [ ] 不要になったインポート文を削除している
- [ ] エクスポートするオブジェクトが正しく定義されている
- [ ] 相対インポートのパスが正確である

### 2.3. API・ルーティング関連
- [ ] APIエンドポイントのパスが一貫している
- [ ] プレフィックスの重複がない
- [ ] ルーターの設定が適切である
- [ ] HTTPメソッド（GET, POST等）が正しく指定されている

### 2.4. データモデル・バリデーション
- [ ] データモデルの定義が完全である
- [ ] 必須フィールドが適切に定義されている
- [ ] バリデーションルールが正確である
- [ ] 国際対応（異なる形式、エンコーディング）を考慮している

## 3. コード変更後の検証チェック

### 3.1. 構文検証
- [ ] インデントや括弧の対応に問題がない
- [ ] 構文エラーがない
- [ ] コメントが正しい形式である
- [ ] 文字列の引用符が適切に閉じられている

### 3.2. 依存関係検証
- [ ] 全ての変数が使用前に定義されている
- [ ] 参照する関数や変数が存在する
- [ ] 循環インポートがない
- [ ] 外部モジュールの依存関係に問題がない

### 3.3. ファイル間整合性
- [ ] インポート文が正しい対象を参照している
- [ ] 複数ファイルにまたがる変更が整合している
- [ ] 共有インターフェースが一貫している
- [ ] 設定値が一貫している

### 3.4. 階層的検証
- [ ] 各ファイルが個別に構文的に正しい
- [ ] インポート/エクスポート関係が機能する
- [ ] コンポーネント間の連携が機能する
- [ ] エンドポイント間の連携が機能する

## 4. 特定のコンポーネント別チェック項目

### 4.1. バックエンド (FastAPI)
- [ ] ルーターのプレフィックスが適切に設定されている
- [ ] エンドポイント関数の引数が正しく定義されている
- [ ] 依存関係の関数が正しく定義されている
- [ ] レスポンスモデルが正しく指定されている
- [ ] 例外処理が適切に実装されている

### 4.2. フロントエンド (React)
- [ ] コンポーネントのインポート文が正確である
- [ ] Reactフックのルールに違反していない
- [ ] 依存配列が正しく指定されている
- [ ] コンポーネントが正しくエクスポートされている
- [ ] APIエンドポイントのURLが正確である

### 4.3. データモデル (Pydantic)
- [ ] モデルクラスのインポートが正確である
- [ ] フィールド定義が正確である
- [ ] バリデーション関数が正確に定義されている
- [ ] モデル設定（Config/model_config）が正確である
- [ ] 必要なEnumクラスが定義・インポートされている

### 4.4. 設定ファイル (JSON, YAML等)
- [ ] ファイル形式が正確である
- [ ] 必須のフィールドが存在する
- [ ] 値が適切な型である
- [ ] フォーマットが一貫している
- [ ] 構文エラーがない（閉じ括弧、カンマの位置等）

## 5. エラーパターン別確認項目

### 5.1. インポート/エクスポートエラー対策
- [ ] 使用する全てのモジュール/クラスがインポート文に含まれている
- [ ] インポートパスが正確である
- [ ] エクスポートするオブジェクトが定義されている
- [ ] 名前付きインポート/エクスポートに一貫性がある

### 5.2. バリデーションエラー対策
- [ ] 全ての必須フィールドにバリデーションルールがある
- [ ] 特殊なデータ形式（国際データ等）に対応している
- [ ] エッジケースを考慮したバリデーションがある
- [ ] エラーメッセージが明確に定義されている

### 5.3. 構文・構造エラー対策
- [ ] インデントが一貫している
- [ ] 括弧、引用符のペアが完全である
- [ ] ブロックの開始/終了が適切である
- [ ] セミコロン、カンマの使用が一貫している

### 5.4. ルーティングエラー対策
- [ ] エンドポイントパスが重複していない
- [ ] プレフィックスが適切に設定されている
- [ ] パスパラメータが正しく定義されている
- [ ] クエリパラメータが正しく定義されている

## 6. 検証プロセスの実行手順

### 6.1. 段階的検証アプローチ
1. **構文レベル**: 各ファイルの構文エラーを確認
2. **インポートレベル**: インポート/エクスポート関係を確認
3. **モジュールレベル**: モジュール内の整合性を確認
4. **コンポーネントレベル**: コンポーネント間の連携を確認
5. **システムレベル**: システム全体の動作を確認

### 6.2. 具体的なコマンド例
- バックエンドの構文チェック: `read_code`で関連ファイルを確認
- フロントエンドの構文チェック: `read_code`でJSX/TSXファイルを確認
- インポート検証: 関連するすべてのファイルを`read_code`で確認し、依存関係を検証
- エンドポイント整合性: APIとクライアント側の設定を比較

---

## 使用ガイドライン

1. このチェックリストは開発時の参考として使用し、プロジェクトの特性に応じてカスタマイズしてください
2. 特に高頻度で発生するエラータイプ（インポート/エクスポート、部分更新による整合性崩壊）に注意してください
3. 小さな変更でも、影響範囲が大きい可能性があることを認識してください
4. チェックリストを段階的に適用し、早期に問題を発見することが重要です

---

作成日: 2025年5月5日  
最終更新: 2025年5月5日